// encoding: utf-8
// jQuery.fn.jsincludes 1.0 - MIT/GPL Licensed - More info: http://github.com/maranomynet/jsincludes/
(function(e){var g='jsincludes',k='virtualBrowser',s=function(a,b){if(b.isFirst){e(this).remove()[k]('disengage')}},t=function(a,b){var c=e(this),f=c.data(k).cfg,d=b.resultDOM;if(f.disengage){c.before(d).detach();setTimeout(function(){e('<div/>').append(c).empty()},999)}if(f.setFocus&&e.setFocus){d.setFocus()}},l=function(a){var b=e(this),c=b.data(g),f=c.link,d=c.cfg,m=f[0].href.split('#')[1];d.selector=(m&&'#'+m)||f.attr('data-selectors')||d.selector;if(a){d.setFocus=1}e('<div/>').bind('VBerror',s).one('VBloaded',t).replaceAll(b)[k](d,f);a&&a.preventDefault()},o,p=function(a){clearTimeout(o);o=setTimeout(function(){q()},n.refresh)},j,r,h=[],q=function(a){a=a||[];j=j||e(window);var b=j.scrollTop()+j.height();if(a.length||b!=r){h.push.apply(h,a);var c=h.length,f=c-(a.length||c),d,m=[];while(c-->f){d=e(h[c]);if(d.offset().top<b+(d.data(g).cfg.unseenBuffer||0)){l.call(d[0]);h.splice(c,1)}}r=b}},u,n=e.fn[g]=function(f){if(f=='refresh'){p()}else{var d=[];this.each(function(){var a=e(this),b=e.extend(new i(),i,f);if(!a.data(g)){var c=a.is('a')?a:a.find('a').not(b.noIncl);c.each(function(){link=e(this),elm=a;if(c.length>1){b=e.extend(new i(),i,f);link.insertBefore(elm).addClass(elm.attr('class'));elm=link}elm.data(g,{link:link,cfg:b});if(elm.is(b.lazyLoad||'')){elm.bind('click',l)}else if(!b.delayUnseen||elm.is(b.forceLoad)){l.call(elm[0])}else{d.push(elm[0])}});if(c.length>1){a.remove()}}});if(d.length){q(d);e(window).bind('resize scroll',p)}}return this},i=n.config=function(){};i.prototype={lazyLoad:'.lazyload',noIncl:'.no-include',loadingClass:'jsi-loading',unseenBuffer:100,forceLoad:'.forceload',disengage:true};n.refresh=100})(jQuery);
