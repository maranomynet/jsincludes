// encoding: utf-8
// jQuery.fn.jsincludes 1.0 - MIT/GPL Licensed - More info: http://github.com/maranomynet/jsincludes/
(function(c){var l='jsincludes',i='virtualBrowser',x=function(e,a){if(a.isFirst){c(this).remove()[i]('disengage')}},y=function(e,a){var d=c(this),f=d.data(i).cfg,b=a.resultDOM;if(f.disengage){d.before(b).detach();setTimeout(function(){c('<div/>').append(d).empty()},999)}if(f.setFocus&&c.setFocus){b.setFocus()}},p=function(a){var d=c(this),f=d.data(l),b=f.link,g=f.vb,h=g.data(i).cfg,j=b[0].href.split('#')[1],k=h.selector;h.selector=b.attr('data-selectors')||(j&&'#'+j)||k;if(a){h.setFocus=1}f.vb.replaceAll(d)[i]('load',b);if(!h.disengage){f.vb.one('VBloaded',function(e){h.selector=k})}a&&a.preventDefault()},r,s=function(e){clearTimeout(r);r=setTimeout(function(){t()},q.refresh)},o,u,m=[],t=function(e){e=e||[];o=o||c(window);var a=o.scrollTop()+o.height();if(e.length||a!=u){m.push.apply(m,e);var d=m.length,f=d-(e.length||d),b,g,h=[];while(d-->f){b=c(m[d]);g=b.data(l).vb.data(i).cfg;if(b.offset().top<a+(g.unseenBuffer||0)){p.call(b[0]);m.splice(d,1)}}u=a}},z,q=c.fn[l]=function(j){if(j=='refresh'){s()}else{var k=[],v=[],w=[];this.each(function(){var b=c(this),g=c.extend(new n(),n,j,{url:null});if(!b.data(l)){var h=b.is('a')?b:b.find('a').not(g.noIncl);h.each(function(){var e=c(this),a=b;if(h.length>1){g=c.extend(new n(),n,j);e.insertBefore(a).addClass(a.attr('class'));a=e}var d=c('<div/>').bind('VBerror',x).one('VBloaded',y)[i](g),f={elm:a,link:e,vb:d};v.push(d[0]);a.add(d).data(l,f);if(a.is(g.lazyLoad||'')){w.push(a[0]);a.bind('click',p)}else if(!g.delayUnseen||a.is(g.forceLoad)){setTimeout(function(){p.call(a[0])},0)}else{k.push(a[0])}});if(h.length>1){b.remove()}}});if(k.length){setTimeout(function(){t(k)},0);c(window).bind('resize scroll',s)}}return{vbBodies:c(v),lazyElms:c(w)}},n=q.config=function(){};n.prototype={lazyLoad:'.lazyload',noIncl:'.no-include',loadingClass:'jsi-loading',unseenBuffer:100,forceLoad:'.forceload',disengage:true};q.refresh=100})(jQuery);
