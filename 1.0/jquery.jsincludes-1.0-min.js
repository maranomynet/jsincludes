// encoding: utf-8
// jQuery.fn.jsincludes 1.0 - MIT/GPL Licensed - More info: http://github.com/maranomynet/jsincludes/
(function(b){var i='jsincludes',l='virtualBrowser',v=function(c,f){if(f.isFirst){b(this).remove()[l]('disengage')}},w=function(c,f){var a=b(this),e=a.data(l).cfg,d=f.resultDOM;if(e.disengage){a.before(d).detach();setTimeout(function(){b('<div/>').append(a).empty()},999)}if(e.setFocus&&b.setFocus){d.setFocus()}},n=function(c){var f=b(this),a=f.data(i),e=a.vb,d=a.link,g=a.cfg,h=d[0].href.split('#')[1];g.selector=(h&&'#'+h)||d.attr('data-selectors')||g.selector;if(c){g.setFocus=1}a.vb.replaceAll(f)[l]('load',d);c&&c.preventDefault()},p,q=function(c){clearTimeout(p);p=setTimeout(function(){r()},o.refresh)},m,s,j=[],r=function(c){c=c||[];m=m||b(window);var f=m.scrollTop()+m.height();if(c.length||f!=s){j.push.apply(j,c);var a=j.length,e=a-(c.length||a),d,g=[];while(a-->e){d=b(j[a]);if(d.offset().top<f+(d.data(i).cfg.unseenBuffer||0)){n.call(d[0]);j.splice(a,1)}}s=f}},x,o=b.fn[i]=function(g){if(g=='refresh'){q()}else{var h=[],t=[],u=[];this.each(function(){var a=b(this),e=b.extend(new k(),k,g,{url:null});if(!a.data(i)){var d=a.is('a')?a:a.find('a').not(e.noIncl);d.each(function(){link=b(this),elm=a;if(d.length>1){e=b.extend(new k(),k,g);link.insertBefore(elm).addClass(elm.attr('class'));elm=link}var c=b('<div/>').bind('VBerror',v).one('VBloaded',w)[l](e),f={elm:elm,link:link,vb:c,cfg:e};t.push(c[0]);elm.add(c).data(i,f);if(elm.is(e.lazyLoad||'')){u.push(elm[0]);elm.bind('click',n)}else if(!e.delayUnseen||elm.is(e.forceLoad)){setTimeout(function(){n.call(elm[0])},0)}else{h.push(elm[0])}});if(d.length>1){a.remove()}}});if(h.length){setTimeout(function(){r(h)},0);b(window).bind('resize scroll',q)}}return{vbBodies:b(t),lazyElms:b(u)}},k=o.config=function(){};k.prototype={lazyLoad:'.lazyload',noIncl:'.no-include',loadingClass:'jsi-loading',unseenBuffer:100,forceLoad:'.forceload',disengage:true};o.refresh=100})(jQuery);
