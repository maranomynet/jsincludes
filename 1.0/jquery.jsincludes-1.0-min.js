// jQuery.fn.jsincludes 1.0 - MIT/GPL Licensed - More info: http://github.com/maranomynet/jsincludes/
!function(e){var t="jsincludes",s="virtualBrowser",i="disengage",a,n=function(t,a){if(a.isFirst){e(this).remove()[s](i)}},o=function(t,a){var n=e(this),o=n.data(s).cfg,r=a.resultDOM;if(o[i]){n.before(r).detach();setTimeout(function(){e("<div/>").append(n).empty()},999)}if(o.setFocus&&e.setFocus){r.setFocus()}},r=function(n){var o=e(this),r=o.data(t);if(r){var l=r.link,f=r.vb.data(s).cfg,c=l[0].href.split("#")[1],d=f.selector;f.selector=l.attr("data-selectors")||c&&"#"+c||d;if(n!==a){u.splice(e.inArray(o[0],u),1);if(n.target){n.preventDefault();f.setFocus!==false&&(f.setFocus=1)}}r.vb.addClass(f.firstLoadClass).replaceAll(o)[s]("load",l);if(!f[i]){r.vb.one("VBloaded",function(){r.vb.removeClass(f.firstLoadClass);f.selector=d})}}},l,f=function(){clearTimeout(l);l=setTimeout(function(){h()},v.refresh)},c,d,u=[],h=function(i){i=i||[];c=c||e(window);var a=c.scrollTop()+c.height();if(i.length||a!==d){u.push.apply(u,i);var n=u.length,o=n-(i.length||n),l,f;while(n-->o){l=e(u[n]);f=l.data(t).vb.data(s).cfg;if(l.offset().top<a+(f.unseenBuffer||0)){r.call(l[0]);u.splice(n,1)}}d=a}},v=e.fn[t]=function(a){if(a==="refresh"){f()}else if(a==="load"){this.each(r)}else{var l=[],c=[],d=[];this.each(function(){var f=e(this),u=e.extend(new p,p,a,{url:null});if(!f.data(t)){var h=f.is("a")?f:f.find("a").not(u.noIncl);h.each(function(){var v=e(this),g=f;if(h.length>1){u=e.extend(new p,p,a);v.insertBefore(g).addClass(g.attr("class"));g=v}if(!g.is(u.recurse)){u[i]=true}var b=e("<div/>").bind("VBerror",n).one("VBloaded",o)[s](u),m={elm:g,link:v,vb:b};c.push(b[0]);g.add(b).data(t,m);if(u.lazyLoad===true||g.is(u.lazyLoad||"")){d.push(g[0]);g.bind("click",r)}else if(!u.delayUnseen||g.is(u.forceLoad)){setTimeout(function(){r.call(g[0])},0)}else{l.push(g[0])}});if(h.length>1){f.remove()}}});if(l.length){setTimeout(function(){h(l)},0);e(window).bind("resize scroll",f)}return{vbBodies:e(c),lazyElms:e(d)}}return this},p=v.config=function(){};p.prototype={lazyLoad:".lazyload",noIncl:".no-include",firstLoadClass:"jsi-loading",unseenBuffer:100,forceLoad:".forceload",recurse:""};v.refresh=100}(jQuery);
